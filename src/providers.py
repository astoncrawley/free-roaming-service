provider_dict = {
    "A": {
        "Name": "1pMobile",
        "Network": "EE",
        "Freeroaming Countries": [
            "Austria",
            "Azores",
            "Balearic Islands",
            "Belgium",
            "Bulgaria",
            "Canary Islands",
            "Croatia",
            "Cyprus (excl North Cyprus)",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Finland",
            "France",
            "French Guiana",
            "Germany",
            "Gibraltar",
            "Greece",
            "Guadeloupe",
            "Guernsey",
            "Hungary",
            "Iceland",
            "Ireland",
            "Isle of Man",
            "Italy",
            "Jersey",
            "Latvia",
            "Liechtenstein",
            "Lithuania",
            "Luxembourg",
            "Madeira",
            "Malta",
            "Martinique",
            "Monaco",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Reunion",
            "Romania",
            "San Marino",
            "Slovakia",
            "Slovenia",
            "Spain",
            "Sweden",
            "Switzerland",
            "Vatican City"
        ],
        "Roaming Cap": "14GB (Unlimited according to MSE)"
    },
    "B": {
        "Name": "Asda Mobile",
        "Network": "Vodafone",
        "Freeroaming Countries": [
            "Aland Islands",
            "Austria",
            "Azores",
            "Balearic Islands",
            "Belgium",
            "Bulgaria",
            "Canary Islands",
            "Croatia",
            "Cyprus (excl North Cyprus)",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Finland",
            "France",
            "French Guiana",
            "Germany",
            "Greece",
            "Guadeloupe",
            "Guernsey",
            "Hungary",
            "Iceland",
            "Ireland",
            "Isle of Man",
            "Italy",
            "Jersey",
            "Latvia",
            "Liechtenstein",
            "Lithuania",
            "Luxembourg",
            "Madeira",
            "Malta",
            "Martinique",
            "Mayotte",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Reunion",
            "Romania",
            "Slovakia",
            "Slovenia",
            "Spain",
            "St. Barthelemy",
            "Sweden",
            "Vatican City"
        ],
        "Roaming Cap": "5GB (Unlimited according to MSE)"
    },
    "C": {
        "Name": "CMLink",
        "Network": "EE",
        "Freeroaming Countries": [
            "??"
        ],
        "Roaming Cap": "??"
    },
    "D": {
        "Name": "CTExcel",
        "Network": "EE",
        "Freeroaming Countries": [
            "??"
        ],
        "Roaming Cap": "??"
    },
    "E": {
        "Name": "Ecotalk",
        "Network": "EE",
        "Freeroaming Countries": [
            None
        ],
        "Roaming Cap": None
    },
    "F": {
        "Name": "EE",
        "Network": "EE",
        "Freeroaming Countries": [
            None
        ],
        "Roaming Cap": None
    },
    "G": {
        "Name": "giffgaff",
        "Network": "O2",
        "Freeroaming Countries": [
            "Austria",
            "Belgium",
            "Bulgaria",
            "Croatia",
            "Cyprus (excl North Cyprus)",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Finland",
            "France",
            "French Guiana",
            "Germany",
            "Gibraltar",
            "Greece",
            "Guadeloupe",
            "Hungary",
            "Iceland",
            "Ireland",
            "Italy",
            "Latvia",
            "Liechtenstein",
            "Lithuania",
            "Luxembourg",
            "Malta",
            "Martinique",
            "Mayotte",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Reunion",
            "Romania",
            "San Marino",
            "Slovakia",
            "Slovenia",
            "Spain",
            "Sweden",
            "Ukraine"
        ],
        "Roaming Cap": "5GB"
    },
    "H": {
        "Name": "Honest Mobile",
        "Network": "Three",
        "Freeroaming Countries": [
            "Austria",
            "Belgium",
            "Bulgaria",
            "Croatia",
            "Cyprus (excl North Cyprus)",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Finland",
            "France",
            "French Guiana",
            "Germany",
            "Gibraltar",
            "Greece",
            "Guadeloupe",
            "Guernsey",
            "Hungary",
            "Iceland",
            "Ireland",
            "Isle of Man",
            "Italy",
            "Jersey",
            "Latvia",
            "Liechtenstein",
            "Lithuania",
            "Luxembourg",
            "Malta",
            "Martinique",
            "Mayotte",
            "Monaco",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Reunion",
            "Romania",
            "Saint Barthelemy",
            "Saint Martin",
            "San Marino",
            "Slovakia",
            "Slovenia",
            "Spain",
            "Sweden",
            "Switzerland"
        ],
        "Roaming Cap": "??"
    },
    "I": {
        "Name": "iD Mobile",
        "Network": "Three",
        "Freeroaming Countries": [
            "Austria",
            "Azerbaijan",
            "Azores",
            "Belarus",
            "Belgium",
            "Bulgaria",
            "Canary Islands",
            "Croatia",
            "Cyprus (excl North Cyprus)",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Finland",
            "France",
            "French Guiana",
            "Germany",
            "Gibraltar",
            "Greece",
            "Guadeloupe",
            "Guernsey",
            "Hungary",
            "Iceland",
            "Ireland",
            "Isle of Man",
            "Italy",
            "Jersey",
            "Kazakhstan",
            "Latvia",
            "Liechtenstein",
            "Lithuania",
            "Luxembourg",
            "Macedonia",
            "Madeira",
            "Malta",
            "Martinique",
            "Monaco",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Reunion",
            "Romania",
            "Saint Barthelemy",
            "Saint Martin",
            "San Marino",
            "Slovakia",
            "Slovenia",
            "Spain",
            "Sweden",
            "Vatican City"
        ],
        "Roaming Cap": "30GB"
    },
    "J": {
        "Name": "Lebara",
        "Network": "Vodafone",
        "Freeroaming Countries": [
            "Austria",
            "Belgium",
            "Bulgaria",
            "Croatia",
            "Cyprus (excl North Cyprus)",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Finland",
            "France",
            "French Guiana",
            "Germany",
            "Gibraltar",
            "Greece",
            "Guadeloupe",
            "Hungary",
            "Iceland",
            "India",
            "Ireland",
            "Italy",
            "Latvia",
            "Liechtenstein",
            "Lithuania",
            "Luxembourg",
            "Malta",
            "Martinique",
            "Mayotte",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Reunion",
            "Romania",
            "Slovakia",
            "Slovenia",
            "Spain",
            "Sweden"
        ],
        "Roaming Cap": "30GB"
    },
    "K": {
        "Name": "Lyca Mobile",
        "Network": "EE",
        "Freeroaming Countries": [
            "??"
        ],
        "Roaming Cap": "??"
    },
    "Y": {
        "Name": "Mozillion",
        "Network": "EE",
        "Freeroaming Countries": [
            "Austria",
            "Balearic Islands",
            "Belgium",
            "Bulgaria",
            "Canary Islands",
            "Croatia","Cyprus (excl North Cyprus)",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Faroe Islands",
            "Finland",
            "France",
            "French Guiana",
            "Germany",
            "Gibraltar",
            "Greece",
            "Guadeloupe",
            "Guernsey",
            "Hungary",
            "Iceland",
            "Ireland",
            "Isle of Man",
            "Italy",
            "Jersey",
            "Latvia",
            "Liechtenstein",
            "Lithuania",
            "Luxembourg",
            "Malta",
            "Martinique",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Reunion",
            "Romania",
            "San Marino",
            "Slovakia",
            "Slovenia",
            "Spain",
            "Sweden",
            "Switzerland"
        ],
        "Roaming Cap": "500MB"
    },
    "L": {
        "Name": "O2",
        "Network": "O2",
        "Freeroaming Countries": [
            "Austria",
            "Azores",
            "Belgium",
            "Bulgaria",
            "Canary Islands",
            "Croatia",
            "Cyprus (excl North Cyprus)",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Finland",
            "France",
            "French Guiana",
            "Germany",
            "Gibraltar",
            "Greece",
            "Guadeloupe",
            "Guernsey",
            "Hungary",
            "Iceland",
            "Ireland",
            "Isle of Man",
            "Italy",
            "Jersey",
            "Latvia",
            "Liechtenstein",
            "Lithuania",
            "Luxembourg",
            "Madeira",
            "Malta",
            "Martinique",
            "Mayotte",
            "Monaco",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Reunion",
            "Romania",
            "Saint Barthelemy",
            "Saint Martin",
            "San Marino",
            "Slovakia",
            "Slovenia",
            "Spain",
            "Sweden",
            "Switzerland",
            "Vatican City"
        ],
        "Roaming Cap": "25GB?"
    },
    "M": {
        "Name": "Sky Mobile",
        "Network": "O2",
        "Freeroaming Countries": [
            None
        ],
        "Roaming Cap": "N/A"
    },
    "N": {
        "Name": "SMARTY",
        "Network": "Three",
        "Freeroaming Countries": [
            "Aland Islands",
            "Austria",
            "Azores",
            "Balearic Islands",
            "Belgium",
            "Bulgaria",
            "Canary Islands",
            "Comoros",
            "Croatia",
            "Cyprus (excl North Cyprus)",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Finland",
            "France",
            "French Guiana",
            "Germany",
            "Gibraltar",
            "Greece",
            "Guadeloupe",
            "Hungary",
            "Iceland",
            "Ireland",
            "Italy",
            "Latvia",
            "Lithuania",
            "Luxembourg",
            "Madeira",
            "Malta",
            "Martinique",
            "Mayotte",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Reunion",
            "Romania",
            "Saint Barthelemy",
            "Saint Martin",
            "San Marino",
            "Slovakia",
            "Slovenia",
            "Spain",
            "Sweden",
            "Vatican City"
        ],
        "Roaming Cap": "Unlimited??"
    },
    "O": {
        "Name": "spusu",
        "Network": "EE",
        "Freeroaming Countries": [
            "Austria",
            "Belgium",
            "Bulgaria",
            "Croatia",
            "Cyprus (excl North Cyprus)",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Finland",
            "France",
            "French Guiana",
            "Germany",
            "Gibraltar",
            "Greece",
            "Guadeloupe",
            "Hungary",
            "Iceland",
            "Ireland",
            "Italy",
            "Latvia",
            "Liechtenstein",
            "Lithuania",
            "Luxembourg",
            "Malta",
            "Martinique",
            "Mayotte",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Reunion",
            "Romania",
            "Saint Barthelemy",
            "Saint Martin",
            "Slovakia",
            "Slovenia",
            "Spain",
            "Sweden"
        ],
        "Roaming Cap": "10GB"
    },
    "P": {
        "Name": "Superdrug Mobile",
        "Network": "Three",
        "Freeroaming Countries": [
            "Austria",
            "Belgium",
            "Bulgaria",
            "Comoros",
            "Comoros",
            "Croatia",
            "Cyprus (excl North Cyprus)",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Finland",
            "France",
            "French Guiana",
            "Germany",
            "Gibraltar",
            "Greece",
            "Guernsey",
            "Hungary",
            "Iceland",
            "Ireland",
            "Isle of Man",
            "Italy",
            "Jersey",
            "Latvia",
            "Liechtenstein",
            "Lithuania",
            "Luxembourg",
            "Malta",
            "Mayotte",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Reunion",
            "Romania",
            "Slovakia",
            "Slovenia",
            "Spain",
            "Sweden",
            "Switzerland"
        ],
        "Roaming Cap": "Unlimited ??"
    },
    "Z": {
        "Name": "Talk Home",
        "Network": "EE",
        "Freeroaming Countries": [
            "Australia",
            "Austria",
            "Belgium",
            "Bulgaria",
            "Croatia",
            "Cyprus (excl North Cyprus)",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Finland",
            "France",
            "Germany",
            "Greece",
            "Hungary",
            "Iceland",
            "Ireland","Italy",
            "Latvia",
            "Liechtenstein",
            "Lithuania",
            "Luxembourg",
            "Malta",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Reunion",
            "Romania",
            "San Marino",
            "Slovakia",
            "Slovenia",
            "Spain",
            "Sweden",
            "Ukraine"
        ],
        "Roaming Cap": "Unlimited ??"
    },
    "Q": {
        "Name": "Talkmobile",
        "Network": "Vodafone",
        "Freeroaming Countries": [
            "Austria",
            "Azores",
            "Belgium",
            "Bulgaria",
            "Canary Islands",
            "Croatia",
            "Cyprus (excl North Cyprus)",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Finland",
            "France",
            "French Guiana",
            "Germany",
            "Gibraltar",
            "Greece",
            "Guadeloupe",
            "Guernsey",
            "Hungary",
            "Iceland",
            "Ireland",
            "Isle of Man",
            "Italy",
            "Jersey",
            "Kosovo",
            "Latvia",
            "Liechtenstein",
            "Lithuania",
            "Luxembourg",
            "Madeira",
            "Malta",
            "Martinique",
            "Monaco",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Reunion",
            "Romania",
            "Saint Pierre and Miquelon",
            "San Marino",
            "Slovakia",
            "Slovenia",
            "Spain",
            "Sweden",
            "Switzerland",
            "Ukraine"
        ],
        "Roaming Cap": "Unlimited??"
    },
    "R": {
        "Name": "Tesco Mobile",
        "Network": "O2",
        "Freeroaming Countries": [
            "Austria",
            "Azores",
            "Belgium",
            "Bulgaria",
            "Canary Islands",
            "Croatia",
            "Cyprus (excl North Cyprus)",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Finland",
            "France",
            "French Guiana",
            "Germany",
            "Gibraltar",
            "Greece",
            "Guadeloupe",
            "Guernsey",
            "Hungary",
            "Iceland",
            "Ireland",
            "Isle of Man",
            "Italy",
            "Jersey",
            "Latvia",
            "Liechtenstein",
            "Lithuania",
            "Luxembourg",
            "Madeira",
            "Malta",
            "Martinique",
            "Mayotte",
            "Monaco",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Reunion",
            "Romania",
            "Saint Barthelemy",
            "Saint Martin",
            "San Marino",
            "Slovakia",
            "Slovenia",
            "Spain",
            "Sweden",
            "Switzerland",
            "Vatican City"
        ],
        "Roaming Cap": "Unlimited??"
    },
    "S": {
        "Name": "Three",
        "Network": "Three",
        "Freeroaming Countries": [
            None
        ],
        "Roaming Cap": "N/A"
    },
    "T": {
        "Name": "Your Co-op",
        "Network": "EE",
        "Freeroaming Countries": [
            "Aland Islands",
            "Austria",
            "Belgium",
            "Bulgaria",
            "Canary Islands",
            "Ceuta",
            "Croatia",
            "Cyprus (excl North Cyprus)",
            "Czech Republic",
            "Denmark",
            "Estonia",
            "Faroe Islands",
            "Finland",
            "France",
            "French Guiana",
            "Germany",
            "Gibraltar",
            "Greece",
            "Guadeloupe",
            "Guernsey",
            "Hungary",
            "Iceland",
            "Ireland",
            "Isle of Man",
            "Italy",
            "Jersey",
            "Latvia",
            "Liechtenstein",
            "Lithuania",
            "Luxembourg",
            "Malta",
            "Martinique",
            "Mayotte",
            "Melilla",
            "Monaco",
            "Netherlands",
            "Norway",
            "Poland",
            "Portugal",
            "Reunion",
            "Romania",
            "Saint Barthelemy",
            "Saint Martin",
            "San Marino",
            "Sint Maarten",
            "Slovakia",
            "Slovenia",
            "Spain",
            "Sweden",
            "Switzerland",
            "Vatican City"
        ],
        "Roaming Cap": "Unlimited??"
    },
    "U": {
        "Name": "1GLOBAL",
        "Network": "EE",
        "Freeroaming Countries": [
            "??"
        ],
        "Roaming Cap": "??"
    },
    "V": {
        "Name": "Utility Warehouse",
        "Network": "EE",
        "Freeroaming Countries": [
            "??"
        ],
        "Roaming Cap": "??"
    },
    "W": {
        "Name": "Vodafone",
        "Network": "Vodafone",
        "Freeroaming Countries": [
            None
        ],
        "Roaming Cap": "N/A"
    },
    "X": {
        "Name": "VOXI",
        "Network": "Vodafone",
        "Freeroaming Countries": [
            None
        ],
        "Roaming Cap": "N/A"
    }
    }

print(len(provider_dict))

import plotly.express as px
import country_converter as coco

cc = coco.CountryConverter()

country_list = provider_dict["A"]["Freeroaming Countries"]
print(country_list)

country_list_2 = provider_dict["J"]["Freeroaming Countries"]
print(country_list_2)

roaming_list = [country_list, country_list_2]
print(roaming_list)


iso_list = cc.convert(names=country_list, to='ISO3')
print(iso_list)

iso_list_2 = cc.convert(names=country_list_2, to='ISO3')
print(iso_list_2)

iso_alpha = [iso_list, iso_list_2]
print(iso_alpha)


import pandas as pd

# df = pd.DataFrame(provider_dict)

# print(df.head())


user_ids = []
frames = []

for user_id, d in provider_dict.items():
    user_ids.append(user_id)
    frames.append(pd.DataFrame.from_dict(d))

df = pd.concat(frames)

print(df.head(10))
print(df.tail(10))

# for country in country_list:

# # Create basic choropleth map
# fig = px.choropleth(locations=iso_list, hover_name=country_list,
#                     projection='natural earth',
#                     labels='1pMobile',
#                     title='Free Roaming Countries by Mobile Provider')
# fig.show()

# # Create basic choropleth map
# fig = px.choropleth(locations=iso_list_2, hover_name=country_list_2,
#                     projection='natural earth',
#                     title='Free Roaming Countries by Mobile Provider')
# fig.show()


#### UNCOMMENT IF NEEDED ####
# # Create basic choropleth map
# fig = px.choropleth(data_frame=df,
#                     locations='Freeroaming Countries', 
#                     locationmode='country names',
#                     hover_name='Freeroaming Countries',
#                     hover_data='Name',
#                     projection='natural earth',
#                     color='Name',
#                     title='Free Roaming Countries by Mobile Provider')
# fig.show()



# import plotly.graph_objects as go

# base = px.choropleth(
#     data_frame=df,
#     locations='Freeroaming Countries', 
#     locationmode='country names',
#     hover_name='Freeroaming Countries',
#     hover_data='Name',
#     projection='natural earth',
#     color='Name',
#     title='Free Roaming Countries by Mobile Provider'
# )

# uk = go.Choropleth(
#     locations=["United Kingdom"],
#     locationmode="country names",
#     z=[1],  # dummy value
#     showscale=False,
#     marker=dict(line=dict(color="black", width=1)),
#     colorscale=[[0, "black"], [1, "black"]]
# )

# base.add_trace(uk)
# base.show()



# df_grouped = (
#     df.groupby("Freeroaming Countries")["Name"]
#       .apply(lambda x: ", ".join(sorted(set(x))))  # all providers for each country
#       .reset_index(name="Providers")
# )

# df_grouped.head()

df_grouped = (
    df.groupby("Freeroaming Countries")["Name"]
      .apply(lambda x: "<br>".join(sorted(set(x))))
      .reset_index(name="Providers")
)


df_merged = df.merge(df_grouped, on="Freeroaming Countries", how="left")


# # Create basic choropleth map
# fig = px.choropleth(data_frame=df_merged,
#                     locations='Freeroaming Countries', 
#                     locationmode='country names',
#                     hover_name='Freeroaming Countries',
#                     hover_data='Providers',
#                     projection='natural earth',
#                     color='Name',
#                     title='Free Roaming Countries by Mobile Provider')
# fig.show()




import plotly.express as px

# Combine palettes to get at least 26 colors
palette = px.colors.qualitative.Alphabet + px.colors.qualitative.Set3
len(palette)  # >=26

providers = sorted(df['Name'].unique())  # 26 providers
color_map = {provider: palette[i] for i, provider in enumerate(providers)}


# Create basic choropleth map
fig = px.choropleth(data_frame=df_merged,
                    locations='Freeroaming Countries', 
                    locationmode='country names',
                    hover_name='Freeroaming Countries',
                    hover_data='Providers',
                    projection='natural earth',
                    color='Name',
                    color_discrete_map=color_map,
                    title='Free Roaming Countries by Mobile Provider')
fig.show()